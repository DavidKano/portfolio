---
export interface Props {
  id?: string;
  label: string;
  kind?: string;
  href?: string;
  target?: string;
  img?: string; // ruta a PNG/SVG en /public o importado desde assets
}

const {
  id,
  label,
  kind = 'folder',
  href = '',
  target = '_self',
  img = ''
} = Astro.props;

// Â¿hay slot <slot name="icon">?
const hasSlot = Astro.slots?.has?.('icon');
---

{href ? (
  <a href={href} target={target} rel={target === '_blank' ? 'noopener' : undefined}
     class="w-24 md:w-28 flex flex-col items-center gap-2 text-white group focus:outline-none">
    <div class="win-icon-tile w-16 h-16 rounded-2xl grid place-content-center bg-black/30 border border-white/20 backdrop-blur-sm group-hover:bg-black/40">

      {img ? (
        <img src={img} alt="" class="w-8 h-8 object-contain" loading="lazy" />
      ) : hasSlot ? (
        <slot name="icon" />
      ) : (
        <svg viewBox="0 0 24 24" class="w-8 h-8" aria-hidden="true">
          {kind === 'folder' && <path fill="currentColor" d="M10 4l2 2h8a2 2 0 012 2v9a3 3 0 01-3 3H5a3 3 0 01-3-3V7a3 3 0 013-3h5z" />}
          {kind === 'code'   && <path fill="currentColor" d="M8 17l-4-5l4-5v10m8 0V7l4 5l-4 5M13 5l-2 14" />}
          {kind === 'cert'   && <path fill="currentColor" d="M12 2l2.4 4.9L20 8l-3.6 3.5L17 18l-5-2.6L7 18l.6-6.5L4 8l5.6-1.1z" />}
          {kind === 'mail'   && <path fill="currentColor" d="M4 6h16a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2m0 2l8 5l8-5" />}
          {kind === 'pdf'    && <path fill="currentColor" d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12V8m-4-6v6h6" />}
          {kind === 'globe'  && <path fill="currentColor" d="M12 2a10 10 0 100 20a10 10 0 000-20m0 2c2.5 0 4.7 1.7 5.4 4H6.6C7.3 5.7 9.5 4 12 4m-8 8c0-.7.1-1.4.3-2h15.4c.2.6.3 1.3.3 2s-.1 1.4-.3 2H4.3A7.9 7.9 0 014 12m6 8c-2.5 0-4.7-1.7-5.4-4h10.8c-.7 2.3-2.9 4-5.4 4z" />}
        </svg>
      )}

    </div>
    <span class="text-[11px] md:text-xs text-center leading-tight px-1 py-1 rounded win-icon-label">{label}</span>
  </a>
) : (
  <button data-open={id} aria-haspopup="dialog"
          class="w-24 md:w-28 flex flex-col items-center gap-2 text-white group focus:outline-none">
    <div class="win-icon-tile w-16 h-16 rounded-2xl grid place-content-center bg-black/30 border border-white/20 backdrop-blur-sm group-hover:bg-black/40">

      {img ? (
        <img src={img} alt="" class="w-8 h-8 object-contain" loading="lazy" />
      ) : hasSlot ? (
        <slot name="icon" />
      ) : (
        <svg viewBox="0 0 24 24" class="w-8 h-8" aria-hidden="true">
          {kind === 'folder' && <path fill="currentColor" d="M10 4l2 2h8a2 2 0 012 2v9a3 3 0 01-3 3H5a3 3 0 01-3-3V7a3 3 0 013-3h5z" />}
          {kind === 'code'   && <path fill="currentColor" d="M8 17l-4-5l4-5v10m8 0V7l4 5l-4 5M13 5l-2 14" />}
          {kind === 'cert'   && <path fill="currentColor" d="M12 2l2.4 4.9L20 8l-3.6 3.5L17 18l-5-2.6L7 18l.6-6.5L4 8l5.6-1.1z" />}
          {kind === 'mail'   && <path fill="currentColor" d="M4 6h16a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2m0 2l8 5l8-5" />}
          {kind === 'pdf'    && <path fill="currentColor" d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12V8m-4-6v6" />}
          {kind === 'globe'  && <path fill="currentColor" d="M12 2a10 10 0 100 20a10 10 0 000-20m0 2c2.5 0 4.7 1.7 5.4 4H6.6C7.3 5.7 9.5 4 12 4m-8 8c0-.7.1-1.4.3-2h15.4c.2.6.3 1.3.3 2s-.1 1.4-.3 2H4.3A7.9 7.9 0 014 12m6 8c-2.5 0-4.7-1.7-5.4-4h10.8c-.7 2.3-2.9 4-5.4 4z" />}
        </svg>
      )}

    </div>
    <span class="text-[11px] md:text-xs text-center leading-tight px-1 py-1 rounded win-icon-label">{label}</span>
  </button>
)}
